generator client {
  provider = "prisma-client-js"
  output   = "../node_modules/.prisma/client"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Shift {
  id                  BigInt      @id @unique @default(autoincrement())
  event_no            Int         @default(null) 
  patrol_id           BigInt   
  start_time          DateTime    @db.Timestamptz(0)
  end_time            DateTime    @db.Timestamptz(0)
  police_station_base String
  observer_id         BigInt
  driver_id           BigInt
  guest_patroller     GuestPatroller[]?
  vehicle_id          BigInt
  Patrol              patrols_dev @relation(fields: [patrol_id], references: [id])
  Observer            members_dev @relation(fields: [observer_id], references: [id])
  Driver              members_dev @relation(fields: [driver_id], references: [id])
}

model GuestPatrollers {
  id           BigInt  @id @unique @default(autoincrement())
  name         String
  isRegistered Boolean
  member_id    BigInt?
  shift_id     BigInt
  Shift        Shift   @relation(fields: [shift_id], references: [id])
}

model Vehicle {
  id                  BigInt       @id @unique @default(autoincrement())
  patrol_id           Int
  registration_no     String       @unique
  colour              String
  model               String
  make                String
  hasLiveryOrSignage  Boolean
  hasPoliceRadio      Boolean
  Patrol              patrols_dev @relation(fields: [patrol_id], references: [id])
}

model EquipmentChecklist {
  id               BigInt    @id @unique @default(autoincrement())
  hi_viz_uniform   Boolean
  first_aid_kit    Boolean
  torch_or_wand    Boolean
  fireExtinguisher Boolean
  roadCones        Boolean
  addtionalItems   String[]?
  note             String?
}

model VehicleCheckList {
  id               BigInt  @id @unique @default(autoincrement())
  externalLighting Boolean
  lightAndAlley    Boolean
  DashCamOperation Boolean
  note             String?
}

model VehicleDetails {
  id                              BigInt            @id @unique @default(autoincrement())
  vehicle_id                      BigInt            
  hasWof                          Boolean
  hasRegistration                 Boolean
  isSafe                          Boolean
  hasVisibleDamage                Boolean
  visible_damage_note             String?
  vehicle_checkList_id            BigInt
  equipment_checklist_id          BigInt
  isVehicleManagerAttentionNeeded boolean
  Vehicle                         Vehicle            @relation(fields: [vehicle_id], references: [id])
  VehicleCheckList                VehicleCheckList   @relation(fields: [vehicle_checkList_id], references: [id])
  EquipmentChecklist              EquipmentChecklist @relation(fields: [equipment_checklist_id], references: [id])
}

model Observations {
  id                        BigInt   @id @unique @default(autoincrement())
  start_time                DateTime @db.Timestamptz(0)
  end_time                  DateTime @db.Timestamptz(0)
  location                  String          
  isPoliceOrSecurityPresent Boolean
  incidentCategory          String
  incidentSubCategory       String
  description               String
  report_id                 BigInt
  Report                    Report   @relation(fields: [report_id], references: [id])                 
}

model IncidentTypes {
  incidentCategory    String
  incidentSubCategory String

  @@id([incidentCategory, incidentSubCategory])
}

model Report {
  id                       BigInt          @id @unique @default(autoincrement())
  member_id                BigInt
  shift_id                 BigInt
  vehicle_details_id       BigInt
  odometer_initial_reading Int  
  odometer_final_reading   Int
  weather_condition        Weather
  isFootPatrol             Boolean
  observations             Observations[]?
  notes                    String
}

model Amendment {
  id                 Int      @id @unique @default(autoincrement())
  shiftHoursChange   Decimal?
  policeStationBase  String?
  cpCallSign         String?
  amendmentPatrolId  Int
  vehicleId          Int
  hasLiveryOrSignage Boolean?
  hasPoliceRadio     Boolean?
  amendmentMadeAt    DateTime @default(now())
  otherPatrolsName   String?
  shiftId            Int
  shiftType          logType  @default(logOn)
  Patrols            Patrols  @relation(fields: [amendmentPatrolId], references: [id])
  Shifts             Shifts   @relation(fields: [shiftId, shiftType], references: [id, type])
  Vehicles           Vehicles @relation(fields: [vehicleId], references: [id])
}

model IncidentType {
  incidentType String    @id @unique
  description  String
  Reports      Reports[]
}

model Patrols {
  id            Int         @id @unique @default(autoincrement())
  password      String
  email         String      @unique
  name          String
  supervisorID  Int?        @unique
  role          Role        @default(patrol)
  mobile        String
  Amendment     Amendment[]
  Patrols       Patrols?    @relation("PatrolsToPatrols", fields: [supervisorID], references: [id])
  other_Patrols Patrols?    @relation("PatrolsToPatrols")
  Reports       Reports[]
  Shifts        Shifts[]
  Vehicles      Vehicles[]
}

model Reports {
  id                 Int          @id @unique @default(autoincrement())
  title              String
  createdAt          DateTime     @default(now())
  location           String
  patrolID           Int
  reportIncidentType String
  Patrols            Patrols      @relation(fields: [patrolID], references: [id])
  IncidentType       IncidentType @relation(fields: [reportIncidentType], references: [incidentType])
}

model Shifts {
  id                 Int         @default(autoincrement())
  type               logType
  expectedHours      Decimal?
  actualHours        Decimal?
  policeStationBase  String
  cpCallSign         String
  logPatrolId        Int
  otherPatrolsName   String
  vehicleId          Int
  hasLiveryOrSignage Boolean
  hasPoliceRadio     Boolean
  logAt              DateTime    @default(now())
  Amendment          Amendment[]
  Patrols            Patrols     @relation(fields: [logPatrolId], references: [id])
  Vehicles           Vehicles    @relation(fields: [vehicleId], references: [id])

  @@id([id, type])
}

model Vehicles {
  id           Int         @id @unique @default(autoincrement())
  numberPlate  String      @unique
  registration String
  make         String
  model        String
  patrolID     Int
  Amendment    Amendment[]
  Shifts       Shifts[]
  Patrols      Patrols     @relation(fields: [patrolID], references: [id])
}

model district_stats_dev {
  id                BigInt    @id
  created_at        DateTime? @db.Timestamptz(6)
  updated_at        DateTime? @db.Timestamptz(6)
  district_id       BigInt
  year              BigInt
  month             BigInt
  vehicle_related   Int?      @db.SmallInt
  property_related  Int?      @db.SmallInt
  damaged_property  Int?      @db.SmallInt
  disorder_related  Int?      @db.SmallInt
  people_related    Int?      @db.SmallInt
  special_service   Int?      @db.SmallInt
  kms_travelled     Float?
  patrol_hours      Float?
  camera_hours      Float?
  training          Float?
  administration    Float?
  submitter_cpnz_id BigInt
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model district_stats_prod {
  id                BigInt    @id(map: "district_stats_pkey")
  created_at        DateTime? @db.Timestamptz(6)
  updated_at        DateTime? @db.Timestamptz(6)
  district_id       BigInt
  year              BigInt
  month             BigInt
  vehicle_related   Int?      @db.SmallInt
  property_related  Int?      @db.SmallInt
  damaged_property  Int?      @db.SmallInt
  disorder_related  Int?      @db.SmallInt
  people_related    Int?      @db.SmallInt
  special_service   Int?      @db.SmallInt
  kms_travelled     Float?
  patrol_hours      Float?
  camera_hours      Float?
  training          Float?
  administration    Float?
  submitter_cpnz_id BigInt
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model districts_dev {
  id         BigInt    @id
  created_at DateTime? @db.Timestamptz(6)
  updated_at DateTime? @db.Timestamptz(6)
  name       Region    @unique @default(Mt_Roskill)
  email      String    @default("office@cpnz.org.nz")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model districts_prod {
  id           BigInt         @id(map: "districts_pkey")
  created_at   DateTime?      @db.Timestamptz(6)
  updated_at   DateTime?      @db.Timestamptz(6)
  name         String         @unique(map: "districts_name_key")
  email        String         @default("office@cpnz.org.nz")
  patrols_dev  patrols_dev[]
  patrols_prod patrols_prod[]
}

model imports_dev {
  id                 BigInt    @id
  created_at         DateTime? @db.Timestamp(6)
  updated_at         DateTime? @db.Timestamp(6)
  short_patrol_name  String
  live_entries       String
  list_but_no_card   String
  cpnz_id            String
  entry_date         String
  current_card_count String
  surname            String
  first_names        String
  known_as           String
  dob                String
  gender             String
  driver_licence     String
  vetting_date       String
  business           String
  home               String
  cellular           String
  address            String
  suburb             String
  city               String
  post_code          String
  email              String
  patroller          String
  coordinator        String
  secretary          String
  training_officer   String
  nationality        String
  language           String
  skills2            String
  skills3            String
  skills4            String
  skills5            String
  skills6            String
  patrol_name        String
  district           String
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model imports_prod {
  id                 BigInt    @id(map: "imports_pkey")
  created_at         DateTime? @db.Timestamp(6)
  updated_at         DateTime? @db.Timestamp(6)
  short_patrol_name  String
  live_entries       String
  list_but_no_card   String
  cpnz_id            String
  entry_date         String
  current_card_count String
  surname            String
  first_names        String
  known_as           String
  dob                String
  gender             String
  driver_licence     String
  vetting_date       String
  business           String
  home               String
  cellular           String
  address            String
  suburb             String
  city               String
  post_code          String
  email              String
  patroller          String
  coordinator        String
  secretary          String
  training_officer   String
  nationality        String
  language           String
  skills2            String
  skills3            String
  skills4            String
  skills5            String
  skills6            String
  patrol_name        String
  district           String
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model members_dev {
  id                               BigInt        @id
  created_at                       DateTime?     @db.Timestamptz(6)
  updated_at                       DateTime?     @db.Timestamptz(6)
  active_member                    Int           @db.SmallInt
  patrol_id                        BigInt
  district_id                      BigInt
  cpnz_id                          BigInt
  surname                          String
  first_names                      String
  known_as                         String?
  date_of_birth                    String
  gender                           String
  nationality                      String
  driver_licence_number            String
  vetting_date                     String?
  business_phone                   String?
  home_phone                       String?
  mobile_phone                     String?
  address_line_1                   String
  suburb                           String
  city                             String
  post_code                        String
  email                            String        @unique
  patroller                        Int           @db.SmallInt
  officer                          Int           @db.SmallInt
  officer_type                     String
  languages                        String?
  skills                           String?
  notes                            String?
  photo_id                         String
  constabulary                     Int           @default(1) @db.SmallInt
  qi                               String?
  status                           String        @default("active")
  officer_patroller                Int?          @db.SmallInt
  officer_patrol_leader_1          Int?          @db.SmallInt
  officer_patrol_leader_2          Int?          @db.SmallInt
  officer_secretary                Int?          @db.SmallInt
  officer_patrol_trainer           Int?          @db.SmallInt
  officer_avp1                     Int?          @db.SmallInt
  officer_avp2                     Int?          @db.SmallInt
  officer_health_and_safety        Int?          @db.SmallInt
  officer_patrol_member_other      Int?          @db.SmallInt
  officer_district_leader          Int?          @db.SmallInt
  officer_district_trainer         Int?          @db.SmallInt
  officer_district_support_officer Int?          @db.SmallInt
  officer_district_other           Int?          @db.SmallInt
  officer_cpnz_staff               Int?          @db.SmallInt
  officer_probationer              Int?          @db.SmallInt
  access_website                   Int?          @db.SmallInt
  trained                          Int           @default(0) @db.SmallInt
  new_nationality                  String        @default("Not known")
  treasurer                        Int?          @db.SmallInt
  call_sign                        Call_Sign     @default(MRCS)
  police_station                   PoliceStation @default(Mt_Roskill_Police_Station)
  password                         String
  logon_status                     LogonStatus   @dafault(No)
  patrols_prod                     patrols_prod  @relation(fields: [patrol_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model members_prod {
  id                               BigInt       @id(map: "members_pkey")
  created_at                       DateTime?    @db.Timestamptz(6)
  updated_at                       DateTime?    @db.Timestamptz(6)
  active_member                    Int          @db.SmallInt
  patrol_id                        BigInt
  district_id                      BigInt
  cpnz_id                          BigInt
  surname                          String
  first_names                      String
  known_as                         String?
  date_of_birth                    String
  gender                           String
  nationality                      String
  driver_licence_number            String
  vetting_date                     String?
  business_phone                   String?
  home_phone                       String?
  mobile_phone                     String?
  address_line_1                   String
  suburb                           String
  city                             String
  post_code                        String
  email                            String?
  patroller                        Int          @db.SmallInt
  officer                          Int          @db.SmallInt
  officer_type                     String
  languages                        String?
  skills                           String?
  notes                            String?
  photo_id                         String
  constabulary                     Int          @default(1) @db.SmallInt
  qi                               String?
  status                           String       @default("active")
  officer_patroller                Int?         @db.SmallInt
  officer_patrol_leader_1          Int?         @db.SmallInt
  officer_patrol_leader_2          Int?         @db.SmallInt
  officer_secretary                Int?         @db.SmallInt
  officer_patrol_trainer           Int?         @db.SmallInt
  officer_avp1                     Int?         @db.SmallInt
  officer_avp2                     Int?         @db.SmallInt
  officer_health_and_safety        Int?         @db.SmallInt
  officer_patrol_member_other      Int?         @db.SmallInt
  officer_district_leader          Int?         @db.SmallInt
  officer_district_trainer         Int?         @db.SmallInt
  officer_district_support_officer Int?         @db.SmallInt
  officer_district_other           Int?         @db.SmallInt
  officer_cpnz_staff               Int?         @db.SmallInt
  officer_probationer              Int?         @db.SmallInt
  access_website                   Int?         @db.SmallInt
  trained                          Int          @default(0) @db.SmallInt
  new_nationality                  String       @default("Not known")
  treasurer                        Int?         @db.SmallInt
  patrols_prod                     patrols_prod @relation(fields: [patrol_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "members_patrol_id_fkey")
}

model patrols_dev {
  id             BigInt         @id
  created_at     DateTime?      @db.Timestamptz(6)
  updated_at     DateTime?      @db.Timestamptz(6)
  name           String
  active         Int            @db.SmallInt
  district_id    BigInt
  notes          String?
  call_sign      String?
  year_joined    String?
  email          String         @default("office@cpnz.org.nz")
  districts_prod districts_prod @relation(fields: [district_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  vehicle_dev    vehicle_dev[]
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model patrols_prod {
  id             BigInt         @id(map: "patrols_pkey")
  created_at     DateTime?      @db.Timestamptz(6)
  updated_at     DateTime?      @db.Timestamptz(6)
  name           String
  active         Int            @db.SmallInt
  district_id    BigInt
  notes          String?
  call_sign      String?
  year_joined    String?
  email          String         @default("office@cpnz.org.nz")
  members_dev    members_dev[]
  members_prod   members_prod[]
  districts_prod districts_prod @relation(fields: [district_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "patrols_district_id_fkey")
}

model stats_dev {
  id                BigInt    @id
  created_at        DateTime? @db.Timestamptz(6)
  updated_at        DateTime? @db.Timestamptz(6)
  patrol_id         BigInt
  year              Int       @db.SmallInt
  month             Int       @db.SmallInt
  vehicle_related   Int?      @db.SmallInt
  property_related  Int?      @db.SmallInt
  damaged_property  Int?      @db.SmallInt
  disorder_related  Int?      @db.SmallInt
  people_related    Int?      @db.SmallInt
  special_service   Int?      @db.SmallInt
  kms_travelled     Float?
  patrol_hours      Float?
  camera_hours      Float?
  training          Float?
  administration    Float?
  submitter_cpnz_id BigInt
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model stats_prod {
  id                BigInt    @id(map: "stats_pkey")
  created_at        DateTime? @db.Timestamptz(6)
  updated_at        DateTime? @db.Timestamptz(6)
  patrol_id         BigInt
  year              Int       @db.SmallInt
  month             Int       @db.SmallInt
  vehicle_related   Int?      @db.SmallInt
  property_related  Int?      @db.SmallInt
  damaged_property  Int?      @db.SmallInt
  disorder_related  Int?      @db.SmallInt
  people_related    Int?      @db.SmallInt
  special_service   Int?      @db.SmallInt
  kms_travelled     Float?
  patrol_hours      Float?
  camera_hours      Float?
  training          Float?
  administration    Float?
  submitter_cpnz_id BigInt
}

model users_dev {
  id             BigInt    @id
  email          String    @unique
  password       String
  access_level   String
  member_id      BigInt
  remember_token String?
  created_at     DateTime? @db.Timestamptz(6)
  updated_at     DateTime? @db.Timestamptz(6)
  district       BigInt?
  patrol         BigInt?
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model users_prod {
  id             BigInt    @id(map: "users_pkey")
  email          String    @unique(map: "users_email_key")
  password       String
  access_level   String
  member_id      BigInt
  remember_token String?
  created_at     DateTime? @db.Timestamptz(6)
  updated_at     DateTime? @db.Timestamptz(6)
  district       BigInt?
  patrol         BigInt?
}

model vehicle_dev {
  name                String         @id @default("")
  created_at          DateTime       @default(now()) @db.Timestamptz(6)
  model               String
  registration_number String
  colour              String?
  livery              Boolean?
  patrolID            BigInt
  selected            Boolean        @default(false)
  id                  Int            @default(2)
  vehicles_model      vehicles_model @relation(fields: [model], references: [name], onDelete: NoAction, onUpdate: NoAction)
  patrols_dev         patrols_dev    @relation(fields: [patrolID], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model vehicle_make {
  name           String           @id(map: "Vehicle_Make_pkey") @default("")
  vehicles_model vehicles_model[]
}

model vehicles_model {
  name         String        @id(map: "Vehicles_Model_pkey")
  model_name   String?
  vehicle_dev  vehicle_dev[]
  vehicle_make vehicle_make? @relation(fields: [model_name], references: [name], onDelete: NoAction, onUpdate: NoAction, map: "Vehicles_Model_model_name_fkey")
}

enum Call_Sign {
  MRCS
  MACS

  @@map("Call Sign")
}

/// This enum is commented in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
enum PoliceStation {
  Mt_Roskill_Police_Station @map("Mt Roskill Police Station")
  Mt_Albert_Police_Station  @map("Mt Albert Police Station")
}

enum Region {
  Mt_Albert  @map("Mt Albert")
  Mt_Roskill @map("Mt Roskill")
  Epsom
  Howick
}

enum Role {
  patrol
  lead
  admin
}

enum logType {
  logOn
  logOff
}

enum LogonStatus {
  No
  Pending
  Yes
}

emum Weather {
  Wet
  Dry
}
